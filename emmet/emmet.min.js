function createEmmetNodes(texto)
{var sentence=new Emmet(texto);return sentence.generateNodes();}
var Emmet=function()
{if(arguments.length>=1)
{if(typeof(arguments[0])=="string"||arguments[0].indexOf(">")!=-1)
{this.texto=arguments[0];}}}
Emmet.prototype.add=function(abbr)
{this.texto=this.texto+"("+abbr+")";return this.texto}
Emmet.prototype.remove=function(inicio,final)
{var sub=this.texto.substring(inicio,final);this.texto=this.texto.replace(sub,"");return this.texto;}
Emmet.prototype.removeAll=function()
{this.texto="";return this.texto;}
Emmet.prototype.search=function(cadena)
{var empieza=0;if(arguments.length>=2)
{if(typeof(arguments[1])=="number")
{empieza=parseInt(arguments[1]);}}
var indice=this.texto.indexOf(cadena,empieza);return indice;}
Emmet.prototype.generateNodes=function()
{return generarEstructura(this.texto);}
Emmet.prototype.generateHTML=function()
{var contenedor=this.generateNodes(this.texto);var div=document.createElement("div");div.appendChild(contenedor);return div.innerHTML;}
function generarEstructura(sentencia)
{var extracto=document.createDocumentFragment();sentencia+=";";var tabladesignos=sentencia.match(/[#|\.|\w|\{|\(][\w|\[|\]|\{|\}|\=|\s|\$|\-|\_|\(|\)|\#|\.|\@|\,|&|Ã±|%|:]*[>|^|\+|*|;]+/g);var proximosigno=">";var ultimoelemento=extracto;var insidemultipl=0;var tablainside=[];var elemento="";var nodoprimario="";var altura=1;for(var a=0;a<tabladesignos.length;a++)
{var signos=tabladesignos[a];var elm=crearElemento(signos,ultimoelemento);if(signos.charAt(0)=="(")
{if(signos.indexOf(")")==-1)
{nodoprimario=elm;}}
var nuevosigno=signos.charAt(signos.length-1).trim();if(nuevosigno=='^')
{var indice=signos.indexOf('^');if(indice!=signos.length-1)
{altura=((signos.length-1)-indice)+1;}}
if(nuevosigno=='*')
{elemento=elm;proximosigno=nuevosigno;}
else
{if(typeof(elm)=="object")
{elm=autonumerar(elm,0,1,false);}
switch(proximosigno.charAt(0))
{case'>':if(insidemultipl==0)
{ultimoelemento.appendChild(elm);ultimoelemento=elm;proximosigno=nuevosigno;}else if(insidemultipl==1||insidemultipl==2)
{if(insidemultipl==1)
{for(var b=0;b<tablainside.length;b++)
{var clon=elm.cloneNode(true);if(b==0)
{tablainside[b].appendChild(elm);}else
{tablainside[b].appendChild(clon);}}}
if(insidemultipl==2)
{insidemultipl=0}else
{insidemultipl=2;};ultimoelemento=elm;proximosigno=nuevosigno;}
break;case'+':if(insidemultipl==0)
{ultimoelemento.parentNode.appendChild(elm);ultimoelemento=elm;proximosigno=nuevosigno;}else if(insidemultipl==2)
{for(var b=0;b<tablainside.length;b++)
{var clon=elm.cloneNode(true);if(b==0)
{tablainside[b].appendChild(elm);}else
{tablainside[b].appendChild(clon);}}
insidemultipl=2;ultimoelemento=elm;proximosigno=nuevosigno;}
break;case'*':if(insidemultipl==0)
{tablainside=[];for(var b=0;b<elm;b++)
{if(b==elm-1)
{var elu=autonumerar(elemento,b,elm,false);ultimoelemento.appendChild(elu);}else
{var elu=autonumerar(elemento,b,elm,true)
ultimoelemento.appendChild(elu);}
tablainside.push(elu);}
(elm>1)?insidemultipl=1:insidemultipl=0;ultimoelemento=elemento;proximosigno=nuevosigno;}else if(insidemultipl==1||insidemultipl==2)
{for(var b=0;b<tablainside.length;b++)
{for(var c=0;c<elm;c++)
{if(c==elm-1&&b==tablainside.length-1)
{tablainside[b].appendChild(autonumerar(elemento,c,elm,false));}else
{tablainside[b].appendChild(autonumerar(elemento,c,elm,true));}}}
insidemultipl=2;ultimoelemento=elemento;proximosigno=nuevosigno;}
break;case'^':insidemultipl=0;for(var subir=0;subir<altura;subir++)
{ultimoelemento=ultimoelemento.parentNode;}
ultimoelemento.parentNode.appendChild(elm);ultimoelemento=elm;proximosigno=nuevosigno;break;}
if(signos.indexOf(")")!=-1&&typeof(nodoprimario)=="object")
{ultimoelemento=nodoprimario;nodoprimario="";insidemultipl=0;}}}
return extracto;}
function crearElemento(signo,ultimo)
{var nombreultimo=ultimo.nodeName;var elm="";var sent=signo.replace(">","").replace(/\^/g,"").replace("*","").replace(";","").replace("+","").replace("$","1").replace("(","").replace(")","");if(isNaN(parseInt(sent)))
{var claseinside=false;var implicit="div";if(nombreultimo=="UL"||nombreultimo=="OL")
{implicit="li";}else if(nombreultimo=="TABLE"||nombreultimo=="THEAD"||nombreultimo=="TBODY"||nombreultimo=="TFOOT")
{implicit="tr";}else if(nombreultimo=="TR")
{implicit="td";}else if(nombreultimo=="SELECT")
{implicit="option";}
var valor=sent.replace("{","").replace("}","").trim();sent=sent.split("[")[0];sent=sent.split("{")[0];if(sent.split(".")[0]!="")
{sent=sent.split(".")[0];}
if(sent.split("#")[0]!="")
{sent=sent.split("#")[0];}
(sent=="")?sent="y":sent=sent;switch(sent.charAt(0))
{case'#':elm=document.createElement(implicit);elm.setAttribute("id",sent.replace("#",""));break;case'.':elm=document.createElement(implicit);elm.setAttribute("class",sent.replace(/\./g,""));claseinside=true;break;case'y':elm=document.createTextNode(valor);break;default:elm=document.createElement(sent);break;}
elm=existeClaseId(signo,elm,claseinside);elm=existeAtributo(signo,elm);elm=existeTexto(signo,elm);return elm;}else
{return parseInt(sent);}}
function existeClaseId(trozo,nodo,claseinside)
{var tablaclases=trozo.match(/\.[\w|\$|\@|\-]*/g)||"nulo";var tablaids=trozo.match(/\#[\w|\$|\@|\-]*/g)||"nulo";if(tablaclases!="nulo")
{var ind=0;for(var cls of tablaclases)
{var cl=cls.replace(".","").trim();if(claseinside=true&&ind==0)
{nodo.className=cl;}
else
{if(nodo.className.indexOf(cl)==-1)
{(nodo.className=="")?nodo.className=cl:nodo.className+=" "+cl;}}
ind++;}}
if(tablaids!="nulo")
{var id0=tablaids[0].replace("#","");nodo.setAttribute("id",id0);}
return nodo;}
function existeAtributo(trozo,nodo)
{var elm=trozo;var attr=elm.match(/\[.*\]/g)||"nulo";if(attr!="nulo")
{var recattr=attr[0];var separacion=recattr.replace("[","").replace("]","").split(",");for(var valor of separacion)
{var pares=valor.split("=");nodo.setAttribute(pares[0],pares[1]);}}
return nodo;}
function existeTexto(trozo,nodo)
{var elm=trozo;var attr=elm.match(/\{.*\}/g)||"nulo";if(attr!="nulo")
{var recattr=attr[0];var texto=recattr.replace("{","").replace("}","");if(texto=="lorem")
{nodo.innerHTML="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fringilla orci ac ante vestibulum consectetur. Quisque vitae risus vitae nisi mattis blandit. Quisque id quam in nunc dignissim volutpat ac sed nunc. Quisque eleifend porttitor eros, eu vulputate sapien fermentum sed. Suspendisse commodo, lectus sed tempor auctor, libero ipsum mattis lorem, sed euismod augue ipsum eu justo. Cras eleifend rhoncus fringilla. Maecenas id arcu gravida nulla vulputate tincidunt in facilisis justo.";}else
{nodo.innerHTML=texto;}}
return nodo;}
function autonumerar(elm,numero,maximo,clonar)
{var nombreu=numero;var arrobas="";if(clonar)
{elm=elm.cloneNode(true);}else
{elm=elm;}
var tabla=elm.attributes;for(var valor of tabla)
{nombreu=numero;var nombre=valor.name;arrobas=valor.value.match(/\@\-\d{0,}|\@\d+/g)||"nulo";var max=maximo-numero;if(arrobas!="nulo")
{var arr=arrobas[0];var num=arr.replace("@","");if(num=="-")
{nombreu=maximo-numero;}else
{if(num.indexOf("-")!=-1)
{nombreu=max-parseInt(num);}
else
{num=parseInt(num);nombreu=numero+num;}}
elm.setAttribute(nombre,valor.value.replace(arr,""));}else
{nombreu++;}
var tbl=valor.value.match(/\$/g)||"nulo";if(tbl!="nulo")
{var potencia=parseInt(parseInt(nombreu)/10);var char="";(potencia.toString().length==1)?(potencia==0)?char="$":char="$$":char=crearDolar(potencia.toString().length);var indice=valor.value.lastIndexOf(char);var cadena="";if(indice!=-1)
{cadena=valor.value.replaceAt(indice,nombreu);cadena=cadena.replace(/\$/g,"0");}else
{cadena=valor.value;for(var c=0;c<tbl.length-1;c++)
{cadena=cadena.replace("$","");}
cadena=cadena.replace("$",nombreu);}
elm.setAttribute(nombre,cadena);}}
numero++;var texto=elm.textContent;arrobas=texto.match(/\@\-\d{0,}|\@\d+/g)||"nulo";var max=maximo-numero;if(arrobas!="nulo")
{var arr=arrobas[0];var num=arr.replace("@","");if(num=="-")
{nombreu=maximo-numero+1;}else
{if(num.indexOf("-")!=-1)
{nombreu=max-parseInt(num);}
else
{num=parseInt(num);nombreu=numero+num;}}
elm.textContent=texto.replace(arr,"");}
texto=elm.textContent;var tbl=texto.match(/\$/g)||"nulo";if(tbl!="nulo")
{var potencia=parseInt(parseInt(nombreu)/10);var char="";(potencia.toString().length==1)?(potencia==0)?char="$":char="$$":char=crearDolar(potencia.toString().length);var indice=texto.lastIndexOf(char);var cadena="";if(indice!=-1)
{cadena=texto.replaceAt(indice,nombreu);cadena=cadena.replace(/\$/g,"0");elm.textContent=cadena;}else
{cadena=texto;for(var c=0;c<tbl.length-1;c++)
{cadena=cadena.replace("$","");}
cadena=cadena.replace("$",nombreu);elm.textContent=cadena;}}
return elm;}
function crearDolar(long)
{var res="";for(var d=0;d<long+1;d++)
{res+="$";}
return res;}
String.prototype.replaceAt=function(index,character){return this.substr(0,index)+character;}